// Visualization based on work by Amelia Bellamy-Royds: http://fiddle.jshell.net/6cW9u/8/
// !Configuration
function findNeighbours(e,t,n,r){var i=[];e.visit(function(e,s,o,u,a){var f=e.point;if(f){var l,u=x(f.x),c=radius;u<t?l=u+c+padding>=t-n:l=t+n+padding>=u-c;l&&i.push(f)}return s-r>t+n+padding&&u+r<t-n-padding});return i}function calculateOffset(e){return function(t){neighbours=findNeighbours(quadroot,x(t.x),radius,e);var n=neighbours.length,r=0,i=0;if(n){var s=n,o=new Array(n);while(s--){var u=neighbours[s],a=radius+radius+padding,f=x(t.x)-x(u.x),l=Math.sqrt(Math.pow(a,2)-Math.pow(f,2));o[s]=[u.offset+l,u.offset-l]}o=o.sort(function(e,t){return e[0]-t[0]});i=r=1/0;s=n;while(s--)if(i>o[s][0]){r=Math.min(i,o[s][0]);i=o[s][1]}else i=Math.min(i,o[s][1])}t.offset=Math.round(Math.abs(r)<Math.abs(i)?r:i);offset=t.offset;offset+=graphOffset;offset+="px";return offset}}var data=[{name:"Clemens",x:5523,img:"./images/clemens.jpg",audio:"./audio/clip1.mp3"},{name:"Humleridderne",x:2431,audio:"./audio/clip2.mp3"},{name:"Østkyst Hustlers",x:3747,img:"./images/hustlers.jpg",audio:"./audio/clip1.mp3"},{name:"Hvid Sjokolade",x:4761,img:"./images/hvidsjokolade.jpg",audio:"./audio/clip2.mp3"},{name:"Johnson",x:1753,img:"./images/johnson.jpg",audio:"./audio/clip1.mp3"},{name:"L.O.C.",x:4042,img:"./images/loc.jpg",audio:"./audio/clip2.mp3"},{name:"Malk de Koijn",x:4750,audio:"./audio/clip1.mp3"},{name:"Marwan",x:1899,img:"./images/marwan.jpg",audio:"./audio/clip2.mp3"},{name:"MC Einar",x:1965,audio:"./audio/clip1.mp3"},{name:"Niarn",x:2743,img:"./images/niarn.jpg",audio:"./audio/clip2.mp3"},{name:"Pede B",x:3893,img:"./images/pedeb.jpg",audio:"./audio/clip1.mp3"},{name:"Per Vers",x:3139,img:"./images/pervers.jpg",audio:"./audio/clip2.mp3"},{name:"Rockers by Choice",x:4137,img:"./images/rockers.jpg",audio:"./audio/clip2.mp3"},{name:"Suspekt",x:4235,img:"./images/suspekt.jpg",audio:"./audio/clip1.mp3"},{name:"Anders Fogh Rasmussen",x:3575,img:"./images/fogh.jpg",audio:"./audio/clip2.mp3"},{name:"Lars Løkke",x:2719,img:"./images/hunk.jpg",audio:"./audio/clip1.mp3"},{name:"Helle Thorning",x:3168,img:"./images/thorning.jpg",audio:"./audio/clip2.mp3"},{name:"Johannes V. Jensen",x:4557,img:"./images/vjensen.jpg",audio:"./audio/clip1.mp3"},{name:"Yahya Hassan",x:3636,img:"./images/yahya.jpg",audio:"./audio/clip2.mp3"}],maxRadius=0,radius=40,padding=10,mobile=!1,width=$("body").width(),margin={top:0,right:70,bottom:0,left:30},graphOffset=200,xMin=1500,xMax=6e3;if(width<769){radius=20;mobile=!0;graphOffset=250;margin.right=50}var chart=d3.select("#chart"),x=d3.scale.linear().domain([xMin,xMax]).range([margin.left,width-margin.right]),quadtree=d3.geom.quadtree().x(function(e){return x(e.x)}).y(0).extent([[x(xMin),0],[x(xMax),0]]),quadroot=quadtree([]);chart.selectAll("div").data(data).enter().append("div").attr("class",function(e){return"artist"}).style("background-image",function(e){return e.img?"url("+e.img+")":"url(./images/none.png)"}).style("left",width/2+"px").style("top","200px").style("opacity","0").each(function(e,t){d3.select(this).transition().delay(50*t).duration(200).style("left",function(e){return x(e.x)+"px"}).style("top",calculateOffset(maxRadius)).style("opacity","1");quadroot.add(e)}).on("mouseover",function(e){var t=parseFloat(d3.select(this).style("left")),n=parseFloat(d3.select(this).style("top"));t-=70;n+=93;d3.select("#tooltip").style("left",t+"px").style("top",n+"px").select("span").html("<strong>"+e.name+"</strong><br />"+e.x+" unikke ord<br />");mobile&&d3.select("#tooltip").style("left","10px").style("top","10px");d3.select("#tooltip").classed("hidden",!1);d3.select(this).select("div").classed("hidden",!1).transition().duration(750).style("opacity","1")}).on("mouseout",function(){d3.select("#tooltip").classed("hidden",!0);d3.select(this).select("div").classed("hidden",!0).transition().duration(250).style("opacity","0")}).append("div").classed("hidden",!0).style("opacity",0).append("img").attr("src","./images/play.png").classed("play",!0).on("click",function(e){var t=new Audio(e.audio);t.play()});var svg=d3.select("svg"),xAxis=d3.svg.axis().scale(x).innerTickSize(0).outerTickSize(0).orient("bottom").ticks(5).tickFormat(function(e){return e});svg.append("g").attr("class","x axis").attr("transform","translate(0,475)").call(xAxis);var scaleLines=[2e3,3e3,4e3,5e3,6e3];for(var i=0;i<scaleLines.length;i++)svg.append("g").attr("class","scale").attr("transform","translate("+x(scaleLines[i])+", 0)").append("line").attr("y1","25").attr("y2","475");